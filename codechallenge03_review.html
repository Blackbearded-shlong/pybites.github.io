
<!DOCTYPE html>
<html lang="en">
<head>
  <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" type="text/css" href="http://pybit.es/theme/stylesheet/style.min.css">
  <link rel="stylesheet" type="text/css" href="http://pybit.es/theme/stylesheet/custom.css">

  <link rel="stylesheet" type="text/css" href="http://pybit.es/theme/pygments/github.min.css">
  <link rel="stylesheet" type="text/css" href="http://pybit.es/theme/font-awesome/css/font-awesome.min.css">




    <link rel="shortcut icon" href="http://pybit.es/favicon.ico" type="image/x-icon">
    <link rel="icon" href="http://pybit.es/favicon.ico" type="image/x-icon">

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="" />


<meta name="author" content="PyBites" />
<meta name="description" content="It's Friday again so we review the code challenge of this week. It's never late to sign up, just fork our challenges repo and start coding." />
<meta name="keywords" content="codechallenges, code review, github, learning, tags, similarity, blog">
<meta property="og:site_name" content="PyBites"/>
<meta property="og:title" content="Code Challenge 03 - PyBites blog tag analysis - Review"/>
<meta property="og:description" content="It's Friday again so we review the code challenge of this week. It's never late to sign up, just fork our challenges repo and start coding."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="http://pybit.es/codechallenge03_review.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2017-01-27 09:00:00+01:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="http://pybit.es/author/pybites.html">
<meta property="article:section" content="Challenges"/>
<meta property="article:tag" content="codechallenges"/>
<meta property="article:tag" content="code review"/>
<meta property="article:tag" content="github"/>
<meta property="article:tag" content="learning"/>
<meta property="article:tag" content="tags"/>
<meta property="article:tag" content="similarity"/>
<meta property="article:tag" content="blog"/>
<meta property="og:image" content="http://pybit.es/images/featured/pybites-code-challenges.png">

<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@pybites" />
<meta name="twitter:title" content="Code Challenge 03 - PyBites blog tag analysis - Review" />
<meta name="twitter:description" content="It's Friday again so we review the code challenge of this week. It's never late to sign up, just fork our challenges repo and start coding." />
<meta name="twitter:image" content="http://pybit.es/images/featured/pybites-code-challenges.png">

  <title>PyBites &ndash; Code Challenge 03 - PyBites blog tag analysis - Review</title>


  <script src="//load.sumome.com/" data-sumo-site-id="4262b3df2bb8820b75b4c7e09ef53c07d4d5376a3c0c6070d2fc19815019fc50" async="async"></script>

</head>
<body>
  <aside>
    <div>
      <a href="http://pybit.es">
        <img src="http://pybit.es/theme/img/profile.png" alt="PyBites" title="PyBites">
      </a>
      <h1><a href="http://pybit.es">PyBites</a></h1>

<p>Python code challenges, tutorials and news, one bite a day</p>
      <nav>
        <ul class="list">
          <li><a href="http://pybit.es/pages/about.html">About</a></li>
          <li><a href="http://pybit.es/pages/archives.html">Archives</a></li>
          <li><a href="http://pybit.es/pages/contact.html">Contact</a></li>
          <li><a href="http://pybit.es/pages/search.html">Search</a></li>

          <li><a href="http://pybit.us14.list-manage.com/subscribe?u=822043293f280259d4b8d2a3e&id=ac7e2eb9ef" target="_blank">Newsletter</a></li>
          <li><a href="https://twitter.com/pybites" target="_blank">Twitter</a></li>
          <li><a href="http://pybit.es/feeds/all.rss.xml" target="_blank">RSS</a></li>
        </ul>
      </nav>

      <ul class="social">
      </ul>
    </div>


  </aside>
  <main>


<article class="single">
  <header>
    <h1 id="codechallenge03_review">Code Challenge 03 - PyBites blog tag analysis - Review</h1>
    <p>
          Posted by <a href="http://pybit.es/author/pybites.html">PyBites</a> on Fri 27 January 2017 in <a href="http://pybit.es/category/challenges.html">Challenges</a>


    </p>
  </header>


  <div>
    <p>It's Friday again so we review the <a href="http://pybit.es/codechallenge03.html">code challenge of this week</a>. It's never late to join, just fork our <a href="https://github.com/pybites/challenges">challenges repo</a> and start coding.</p>
<h2>A possible solution</h2>
<p>See <a href="https://github.com/pybites/challenges/blob/solutions/03/tags.py">here</a> and commented below.</p>
<p>Some learnings:</p>
<ul>
<li>
<p>We use the stdlib to its fullest:</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
<span class="kn">from</span> <span class="nn">difflib</span> <span class="kn">import</span> <span class="n">SequenceMatcher</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">product</span>
<span class="kn">import</span> <span class="nn">re</span>
</pre></div>


</li>
<li>
<p>We define constants at the top. We use maketrans to easily extend replacing multiple characters in the future:</p>
<div class="highlight"><pre><span></span>REPLACE_CHARS = str.maketrans(&#39;-&#39;, &#39; &#39;)
IDENTICAL = 1.0
TOP_NUMBER = 10
RSS_FEED = &#39;rss.xml&#39;
SIMILAR = 0.87
</pre></div>


</li>
<li>
<p>We used a regular expression to show that you can. A better way would be to use a PyPI package like feedparser or BeautifulSoup (see further down). </p>
<div class="highlight"><pre><span></span>TAG_HTML = re.compile(r&#39;<span class="nt">&lt;category&gt;</span>([^<span class="err">&lt;</span>]+)<span class="nt">&lt;/category&gt;</span>&#39;)

def get_tags():
    &quot;&quot;&quot;Find all tags (TAG_HTML) in RSS_FEED.
    Replace dash with whitespace (REPLACE_CHARS)&quot;&quot;&quot;
    with open(RSS_FEED) as f:
        tags = TAG_HTML.findall(f.read().lower())
    return [tag.translate(REPLACE_CHARS) for tag in tags]
</pre></div>


</li>
<li>
<p>For everything counting related you really want to use collections.Counter and its most_common method</p>
<div class="highlight"><pre><span></span>def get_top_tags(tags):
    &quot;&quot;&quot;Get the TOP_NUMBER of most common tags&quot;&quot;&quot;
    return Counter(tags).most_common(TOP_NUMBER)
</pre></div>


</li>
<li>
<p>For similarities we were going to read up on <a href="http://www.nltk.org/">NLTK</a> but stdlib has difflib.SequenceMatcher which makes this very easy (found <a href="http://stackoverflow.com/questions/17388213/find-the-similarity-percent-between-two-strings">on Stackoverflow</a>). We gained quite some performance first matching the first char between tags, but this assumes the first char is always the same. If you don't want that, take that check out. We use itertools.product instead of a double for loop. Lastly yield makes get_similarities a generator which we find more Pythonic.</p>
<div class="highlight"><pre><span></span>def get_similarities(tags):
    &quot;&quot;&quot;Find set of tags pairs with similarity ratio of &gt; SIMILAR&quot;&quot;&quot;
    for pair in product(tags, tags):
        # performance enhancements 1.992s -&gt; 0.144s
        if pair[0][0] != pair[1][0]:
            continue
        pair = tuple(sorted(pair))  # set needs hashable type
        similarity = SequenceMatcher(None, *pair).ratio()
        if SIMILAR &lt; similarity &lt; IDENTICAL:
            yield pair
</pre></div>


</li>
<li>
<p>The calling code was given, printing it here for completeness:</p>
<div class="highlight"><pre><span></span>if __name__ == &quot;__main__&quot;:
    tags = get_tags()
    top_tags = get_top_tags(tags)
    print(&#39;* Top {} tags:&#39;.format(TOP_NUMBER))
    for tag, count in top_tags:
        print(&#39;{:&lt;20} {}&#39;.format(tag, count))
    similar_tags = dict(get_similarities(tags))
    print()
    print(&#39;* Similar tags:&#39;)
    for singular, plural in similar_tags.items():
        print(&#39;{:&lt;20} {}&#39;.format(singular, plural))
</pre></div>


</li>
<li>
<p>Tests pass:</p>
<div class="highlight"><pre><span></span>$ git checkout solutions
$ python test_tags.py 
...
----------------------------------------------------------------------
Ran <span class="m">3</span> tests in 0.153s

OK
</pre></div>


</li>
</ul>
<hr>
<h2>Code challenges != Python's 'preferably only one way'</h2>
<p>We know '&gt;&gt;&gt; import this' says: "There should be one-- and preferably only one --obvious way to do it." and usually there is. Yet for our challenges we encourage people to be creative and not stick to the template + tests per se (we improve the code challenge format as we learn ...). </p>
<p>For example Jeffrey parses our feed directly in <a href="https://gist.github.com/jrjames83/eeda4324116dde12ea8d45c47a151ab0">his solution</a> with requests and BeautifulSoup not stripping off the dash. This is great addition to our solution, using PyPI whenever you can is recommended. Also by parsing the live feed he created us a tool to run this check every now and then (thanks Jeffrey). We like to see different solutions.</p>
<h2>Any issues or feedback?</h2>
<p>What did you learn this challenge? Feel free to share you code in the comments below. </p>
<p>How are you experiencing these challenges? You like the format? What can we do differently and/or better?</p>
<h2>next(challenges)</h2>
<p>Monday we will be back with a fresh new challenge, stay tuned ...</p>
<p>Again to start coding <a href="https://github.com/pybites/challenges">fork our challenges repo</a> or <a href="https://help.github.com/articles/syncing-a-fork/">sync it</a> if you already forked it.</p>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="http://pybit.es/tag/codechallenges.html">codechallenges</a>
      <a href="http://pybit.es/tag/code-review.html">code review</a>
      <a href="http://pybit.es/tag/github.html">github</a>
      <a href="http://pybit.es/tag/learning.html">learning</a>
      <a href="http://pybit.es/tag/tags.html">tags</a>
      <a href="http://pybit.es/tag/similarity.html">similarity</a>
      <a href="http://pybit.es/tag/blog.html">blog</a>
    </p>
  </div>

  <div class="center social-share">
    <p>    Like this article? Share it with your friends!
</p>
    <div class="addthis_native_toolbox"></div>
    <div class="addthis_sharing_toolbox"></div>
  </div>



<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'http-pybit-es';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>
        Please enable JavaScript to view comments.

</noscript>
</article>

    <footer>
<p>&copy; pybites </p>
<p>    Powered by <a href="http://getpelican.com" target="_blank">Pelican</a> - <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> theme by <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a>
</p>    </footer>
  </main>

<!-- Google Analytics -->
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-89294245-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

    <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5859c6a67eb6254d" async="async"></script>


<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " PyBites ",
  "url" : "http://pybit.es",
  "image": "http://pybit.es/theme/img/profile.png",
  "description": "Python code challenges, tutorials and news, one bite a day"
}
</script>
</body>
</html>