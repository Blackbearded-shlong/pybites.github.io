
<!DOCTYPE html>
<html lang="en">
<head>
  <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" type="text/css" href="http://pybit.es/theme/stylesheet/style.min.css">
  <link rel="stylesheet" type="text/css" href="http://pybit.es/theme/stylesheet/custom.css">

  <link rel="stylesheet" type="text/css" href="http://pybit.es/theme/pygments/github.min.css">
  <link rel="stylesheet" type="text/css" href="http://pybit.es/theme/font-awesome/css/font-awesome.min.css">




    <link rel="shortcut icon" href="http://pybit.es/favicon.ico" type="image/x-icon">
    <link rel="icon" href="http://pybit.es/favicon.ico" type="image/x-icon">

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="" />


<meta name="author" content="Bob" />
<meta name="description" content="In this post I review the code of challenge # 1 and refactor it to make it more Pythonic." />
<meta name="keywords" content="challenge, refactoring, code review, best practices, pythonic">
<meta property="og:site_name" content="PyBites"/>
<meta property="og:title" content="Code Challenge #01 - code review"/>
<meta property="og:description" content="In this post I review the code of challenge # 1 and refactor it to make it more Pythonic."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="http://pybit.es/challenge_js_refact.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2017-01-05 09:00:00+01:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="http://pybit.es/author/bob.html">
<meta property="article:section" content="Refactoring"/>
<meta property="article:tag" content="challenge"/>
<meta property="article:tag" content="refactoring"/>
<meta property="article:tag" content="code review"/>
<meta property="article:tag" content="best practices"/>
<meta property="article:tag" content="pythonic"/>
<meta property="og:image" content="http://pybit.es/images/featured/code-challenge-refactoring.png">

<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@pybites" />
<meta name="twitter:title" content="Code Challenge #01 - code review" />
<meta name="twitter:description" content="In this post I review the code of challenge # 1 and refactor it to make it more Pythonic." />
<meta name="twitter:image" content="http://pybit.es/images/featured/code-challenge-refactoring.png">

  <title>PyBites &ndash; Code Challenge #01 - code review</title>


  <script src="//load.sumome.com/" data-sumo-site-id="4262b3df2bb8820b75b4c7e09ef53c07d4d5376a3c0c6070d2fc19815019fc50" async="async"></script>

</head>
<body>
  <aside>
    <div>
      <a href="http://pybit.es">
        <img src="http://pybit.es/theme/img/profile.png" alt="PyBites" title="PyBites">
      </a>
      <h1><a href="http://pybit.es">PyBites</a></h1>

<p>Sharing our passion for Python, one bite a day.</p>
      <nav>
        <ul class="list">
          <li><a href="http://pybit.es/pages/about.html">About</a></li>
          <li><a href="http://pybit.es/pages/archives.html">Archives</a></li>
          <li><a href="http://pybit.es/pages/contact.html">Contact</a></li>
          <li><a href="http://pybit.es/pages/search.html">Search</a></li>

          <li><a href="https://twitter.com/pybites" target="_blank">Twitter</a></li>
          <li><a href="http://pybit.es/feeds/all.rss.xml" target="_blank">RSS</a></li>
        </ul>
      </nav>

      <ul class="social">
      </ul>
    </div>


  </aside>
  <main>


<article class="single">
  <header>
    <h1 id="challenge_js_refact">Code Challenge #01 - code review</h1>
    <p>
          Posted by <a href="http://pybit.es/author/bob.html">Bob</a> on Thu 05 January 2017 in <a href="http://pybit.es/category/refactoring.html">Refactoring</a>


    </p>
  </header>


  <div>
    <h2>Into</h2>
<p>First of all we have to praise Julian learning by challenge, <a href="https://github.com/pybites/blog_code/blob/1f4dc534d43ec2c8582a890a15fb54486b58af39/katas/course_time/js_course_time_scraper.py">submitting his code to github</a> for review, it takes courage.
But he will learn fast his way, he is on his way to become a Python ninja.</p>
<p>Quick round of applause please ...</p>
<p>Please review <a href="http://pybit.es/js_time_scraper_ch.html">the previous post</a> what this challenge was about.</p>
<h2>Making it more Pythonic</h2>
<p>Github's <a href="https://github.com/pybites/blog_code/commits/master/katas/course_time/js_course_time_scraper.py">history link</a> lets you browse all the commits. This is very convenient and it shows the benefit (best practice) of making git commits as small as possible. This actually made it very easy to show all refactorings in a nice chronological order, which I will do in the next section.</p>
<h3>Step by step</h3>
<div class="highlight"><pre><span></span>$ git log --oneline --reverse
...
...
</pre></div>


<ul>
<li>
<p>1f4dc53 add jul challenge script</p>
<p>First I added the script to our <a href="https://github.com/pybites/blog_code/tree/master/katas">katas</a> folder of our <a href="https://github.com/pybites/blog_code">blog_code repo</a>.</p>
</li>
<li>
<p>9dcbd27 added html to kata</p>
<p>I also needed the html source file we are going to parse.</p>
</li>
<li>
<p>ce498d7 add assert for regression</p>
<p>When you refactor always have your tests at hand to make sure you don't mess anything up. This was just a small script so an assert was enough, but for bigger projects you have your unittest (pytest, etc.) test suite.</p>
<div class="highlight"><pre><span></span>assert str(total_hours) == &#39;6.841944444444445&#39;
</pre></div>


</li>
<li>
<p>5a34e5a add calling code in main</p>
<p>I added the <a href="https://docs.python.org/3/library/__main__.html">Top-level script environment</a> to prevent the prints to run if the module is imported: </p>
<div class="highlight"><pre><span></span>if __name__ == &quot;__main__&quot;:
...
</pre></div>


</li>
<li>
<p>dad9b55 no need to pass file around, we have a constant</p>
<p>The search_file methods was called with file, but it was already defined in a constant - HTML_FILE - so we could use that (no method arg needed).</p>
</li>
<li>
<p>9d682fa extract time_regex into constant</p>
<p>time_regex = re.compile(r'(\d+:\d+)')</p>
<p>This was defined in search_file, being a constant I moved / renamed it to a constant at the top of the file: </p>
<div class="highlight"><pre><span></span>TIME_REGEX = re.compile(r&#39;\(\d+:\d+\)&#39;)
</pre></div>


</li>
<li>
<p><a href="https://github.com/pybites/blog_code/commit/57334a65de1b8a01aa852f222141f9e36e0a558c">57334a6 use open in with block to auto-close file handle</a></p>
<p>open(HTML_FILE).read() was used without close(), best practice for reading files is using with: </p>
<div class="highlight"><pre><span></span>with open(HTML_FILE) as f:
    ...
</pre></div>


</li>
<li>
<p><a href="https://github.com/pybites/blog_code/commit/1147bd08424a1c638661bc840bf6851c8d579873">1147bd0 no need for range, can just loop over duration iterator</a></p>
<p>This is probably an inherited C (or other language) style:</p>
<div class="highlight"><pre><span></span>for i in range(len(durations)):
</pre></div>


<p>In Python you can just iterate over a sequence very cleanly with:</p>
<div class="highlight"><pre><span></span>for mm_ss in durations:
</pre></div>


</li>
<li>
<p><a href="https://github.com/pybites/blog_code/commit/bc6ee8a93a4f622687f8811ed571da1ef30c38c7">bc6ee8a can use shortcut += for summing</a></p>
<div class="highlight"><pre><span></span>sum_minutes = sum_minutes + int(minutes)
</pre></div>


<p>can be shortened to:</p>
<div class="highlight"><pre><span></span>sum_minutes += int(minutes)
</pre></div>


</li>
<li>
<p>9ff89d1 better method name for getting all timestamps</p>
</li>
<li>f5db013 no need to predeclare time_list at module level</li>
<li>f862652 one return value from time_calculation, so convert all to seconds</li>
<li>752394b match method name last refactoring</li>
<li>026b9c5 update comments after last refactoring</li>
<li>e4fad91 strip comments as code is pretty self explanatory</li>
<li>76d1b29 strivariable rename</li>
<li>d026a7f do adding/summing on one line</li>
<li>e45ce53 extract colon seperator into constant</li>
<li>9876f96 removed whitespaces to comply with pep8 (used flake8 vim plugin)</li>
</ul>
<hr>
<p>Keep Calm and Code in Python!</p>
<p>-- Bob</p>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="http://pybit.es/tag/challenge.html">challenge</a>
      <a href="http://pybit.es/tag/refactoring.html">refactoring</a>
      <a href="http://pybit.es/tag/code-review.html">code review</a>
      <a href="http://pybit.es/tag/best-practices.html">best practices</a>
      <a href="http://pybit.es/tag/pythonic.html">pythonic</a>
    </p>
  </div>

  <div class="center social-share">
    <p>    Like this article? Share it with your friends!
</p>
    <div class="addthis_native_toolbox"></div>
    <div class="addthis_sharing_toolbox"></div>
  </div>



<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'http-pybit-es';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>
        Please enable JavaScript to view comments.

</noscript>
</article>

    <footer>
<p>&copy; pybites </p>
<p>    Powered by <a href="http://getpelican.com" target="_blank">Pelican</a> - <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> theme by <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a>
</p>    </footer>
  </main>

<!-- Google Analytics -->
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-89294245-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

    <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5859c6a67eb6254d" async="async"></script>


<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " PyBites ",
  "url" : "http://pybit.es",
  "image": "http://pybit.es/theme/img/profile.png",
  "description": "Sharing our passion for Python, one bite a day."
}
</script>
</body>
</html>