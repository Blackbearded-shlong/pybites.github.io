<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>PyBites</title><link>http://pybit.es/</link><description>Python code challenges, tutorials and news, one bite a day</description><atom:link href="http://pybit.es/feeds/modules.rss.xml" rel="self"></atom:link><lastBuildDate>Thu, 12 Jan 2017 23:55:00 +0100</lastBuildDate><item><title>5 cool things you can do with itertools</title><link>http://pybit.es/itertools-examples.html</link><description>&lt;h2&gt;What is itertools?&lt;/h2&gt;
&lt;p&gt;Itertools is a stdlib module that provides functions that create &lt;a href="http://stackoverflow.com/questions/9884132/what-exactly-are-pythons-iterator-iterable-and-iteration-protocols"&gt;iterators&lt;/a&gt; "inspired by constructs from APL, Haskell, and SML". See &lt;a href="https://docs.python.org/3/library/itertools.html"&gt;the docs page&lt;/a&gt;, &lt;a href="https://pymotw.com/2/itertools/"&gt;pymotw&lt;/a&gt;, as well as &lt;a href="https://github.com/vterron/EuroPython-2016/blob/master/kung-fu-itertools.ipynb"&gt;this great EuroPython preso&lt;/a&gt;.&lt;/p&gt;
&lt;h2&gt;5 cool things you can do with itertools&lt;/h2&gt;
&lt;p&gt;I created &lt;a href="https://github.com/pybites/blog_code/blob/master/notebooks/itertools.ipynb"&gt;this notebook&lt;/a&gt; so you can follow along. Below a summary:&lt;/p&gt;
&lt;h3&gt;1. Use product to get all combinations between two iterators&lt;/h3&gt;
&lt;p&gt;Common game techniques: build a card deck or roll two dices:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;itertools&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;random&lt;/span&gt;

&lt;span class="c"&gt;# from Fluent Python&lt;/span&gt;
&lt;span class="n"&gt;ranks&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nb"&gt;list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;JQKA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;suits&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;S D C H&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="c"&gt;# spades diamonds clubs hearts&lt;/span&gt;
&lt;span class="c"&gt;# but instead of double list comprehension, using product&lt;/span&gt;
&lt;span class="n"&gt;cards&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;{}{}&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;itertools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;product&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;suits&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ranks&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Another use case: roll 2 dices (&lt;a href="http://stackoverflow.com/questions/3099987/generating-permutations-with-repetitions-in-python"&gt;SO is your friend&lt;/a&gt;): &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;dice = range(2, 7)
random.choice([p for p in itertools.product(dice, repeat=2)])

# output: 
(5, 2)
(2, 5)
(2, 5)
(6, 5)
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;2. Show a progress spinner for a console app&lt;/h3&gt;
&lt;p&gt;From &lt;a href="https://github.com/vterron/EuroPython-2016/blob/master/kung-fu-itertools.ipynb"&gt;before-mentioned EuroPython preso&lt;/a&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;itertools&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sys&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;time&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;spinner&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;seconds&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;Show an animated spinner while we sleep.&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;symbols&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;itertools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cycle&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;-\|/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;tend&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;seconds&lt;/span&gt;
    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;tend&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="c"&gt;# &amp;#39;\r&amp;#39; is carriage return: return cursor to the start of the line.&lt;/span&gt;
        &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stdout&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;&lt;/span&gt;&lt;span class="se"&gt;\r&lt;/span&gt;&lt;span class="s"&gt;Please wait... &amp;#39;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nb"&gt;next&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;symbols&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="c"&gt;# no newline&lt;/span&gt;
        &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stdout&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;flush&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="c"&gt;# newline&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;__main__&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;spinner&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;3. Use dropwhile to get counts of &amp;gt;= n in a Counter dict&lt;/h3&gt;
&lt;p&gt;Given a books Counter object, get me books with &amp;gt;= 2 occurences. &lt;/p&gt;
&lt;p&gt;I needed this for my &lt;a href="http://bobbelderbos.com/2016/12/code-kata/"&gt;tools of titans kata&lt;/a&gt; to see which books got recommended more than once by Tim Ferriss' podcast guests. &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;def get_multiple_mentions(books, keep=2):
    for key, count in itertools.dropwhile(lambda key_count: key_count[1] &amp;gt;= keep, books.most_common()):
        del books[key]
    return books

# filters all books with count (occurence = 1) out:
Counter({&amp;#39;4-hour-workweek-escape-live-anywhere&amp;#39;: 2,
        &amp;#39;alchemist-paulo-coelho&amp;#39;: 2,
        &amp;#39;atlas-shrugged-ayn-rand&amp;#39;: 3,
        &amp;#39;black-swan-improbable-robustness-fragility&amp;#39;: 2,
        &amp;#39;checklist-manifesto-how-things-right&amp;#39;: 2,
        ...
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;4. Combinations and permutations&lt;/h3&gt;
&lt;p&gt;For the difference read &lt;a href="https://betterexplained.com/articles/easy-permutations-and-combinations/"&gt;this great explanation&lt;/a&gt;. &lt;/p&gt;
&lt;p&gt;Given a list of friends how many pairs can be formed?&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;friends = &amp;#39;bob tim julian fred&amp;#39;.split()
# as these are &amp;quot;Combinatoric generators&amp;quot; I consume them here for example purposes using list()
list(itertools.combinations(friends, 2))

# output:
[(&amp;#39;bob&amp;#39;, &amp;#39;tim&amp;#39;),
(&amp;#39;bob&amp;#39;, &amp;#39;julian&amp;#39;),
(&amp;#39;bob&amp;#39;, &amp;#39;fred&amp;#39;),
(&amp;#39;tim&amp;#39;, &amp;#39;julian&amp;#39;),
(&amp;#39;tim&amp;#39;, &amp;#39;fred&amp;#39;),
(&amp;#39;julian&amp;#39;, &amp;#39;fred&amp;#39;)]
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;How many 4 letter strings can you from 7 letters? (hint: upcoming challenge)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;string&lt;/span&gt;
&lt;span class="n"&gt;letters&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sample&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;string&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ascii_uppercase&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;itertools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;permutations&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;letters&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;span class="c"&gt;# = 840 (7 * 6 * 5 * 4)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;5. Groupby to count amount of keys for specific value in dict&lt;/h3&gt;
&lt;p&gt;Count the number of keys for a value, for example count the number of users (keys) that have email as pref (value) in a user_prefs dict.&lt;/p&gt;
&lt;p&gt;This example is based on the one I found at &lt;a href="https://pymotw.com/2/itertools/"&gt;pymotw&lt;/a&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;# set up dict
users = &amp;#39;tim bob julian sue fred frank maria&amp;#39;.split()
prefs = &amp;#39;email phone IM email F2F email phone&amp;#39;.split()
user_prefs = dict(zip(users, prefs))
user_prefs

user_prefs_sorted = sorted(user_prefs.items(), key=itemgetter(1))
for pref, users in itertools.groupby(user_prefs_sorted, key=itemgetter(1)):
    print(pref, list(map(itemgetter(0), users)))

# output: 
F2F [&amp;#39;fred&amp;#39;]
IM [&amp;#39;julian&amp;#39;]
email [&amp;#39;frank&amp;#39;, &amp;#39;tim&amp;#39;, &amp;#39;sue&amp;#39;]
phone [&amp;#39;bob&amp;#39;, &amp;#39;maria&amp;#39;]
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Other uses?&lt;/h2&gt;
&lt;p&gt;Where do you use itertools mostly for? Share your experience in the comments below ...&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Bob</dc:creator><pubDate>Thu, 12 Jan 2017 23:55:00 +0100</pubDate><guid>tag:pybit.es,2017-01-12:itertools-examples.html</guid><category>iterators</category><category>itertools</category><category>tricks</category><category>generators</category><category>game</category><category>notebooks</category><category>permutations</category></item></channel></rss>